<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>学 | 春风少年兄</title><meta name=keywords content><meta name=description content="学记"><meta name=author content="Me"><link rel=canonical href=https://blog.0pt.im/learn/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.4b652714b710c7fd948e965adf64e815b9d09f68a358365c02ac09b95e5516be.css integrity="sha256-S2UnFLcQx/2UjpZa32ToFbnQn2ijWDZcAqwJuV5VFr4=" rel="preload stylesheet" as=style><link rel=icon href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=icon type=image/png sizes=16x16 href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=icon type=image/png sizes=32x32 href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=apple-touch-icon href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=mask-icon href=https://img.0pt.im/blogbuilt/title.jpeg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.0pt.im/learn/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="学"><meta property="og:description" content="学记"><meta property="og:type" content="website"><meta property="og:url" content="https://blog.0pt.im/learn/"><meta property="og:image" content="https://blog.0pt.im/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="春风少年兄"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.0pt.im/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="学"><meta name=twitter:description content="学记"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.0pt.im/zh/posts/"},{"@type":"ListItem","position":2,"name":"学","item":"https://blog.0pt.im/learn/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.0pt.im/zh/ accesskey=h title="世纪大道 (Alt + H)"><img src=https://blog.0pt.im/apple-touch-icon.png alt aria-label=logo height=35>世纪大道</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.0pt.im/zh/search title=找><span>找</span></a></li><li><a href=https://blog.0pt.im/zh/learn/ title=学><span>学</span></a></li><li><a href=https://blog.0pt.im/zh/music/ title=音><span>音</span></a></li><li><a href=https://blog.0pt.im/zh/game/ title=游><span>游</span></a></li><li><a href=https://blog.0pt.im/zh/think/ title=感><span>感</span></a></li><li><a href=https://blog.0pt.im/zh/link/ title=链><span>链</span></a></li><li><a href=https://blog.0pt.im/zh/archives title=时><span>时</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://blog.0pt.im/zh/>主页</a>&nbsp;»&nbsp;<a href=https://blog.0pt.im/zh/posts/>Posts</a></div><h1>学
<a href=/learn/index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1><div class=post-description>学记</div></header><article class=post-entry><header class=entry-header><h2>从零开始的计算机网络5-1</h2></header><div class=entry-content><p>运输层概述 之前课程所介绍的计算机网络体系结构中的物理层、数据链路层以及网络层它们共同解决了将主机通过异构网络互联起来所面临的问题，实现了主机到主机的通信。
但实际上在计算机网络中进行通信的真正实体是位于通信两端主机中的进程(AP)。
如何为运行在不同主机上的应用进程提供直接的通信服务是运输层的任务，运输层协议又称为端到端协议。
运输层向高层用户屏蔽了下面网络核心的细节(如网络拓扑、所采用的路由选择协议等)，它使应用进程看见的就好像是在两个运输层实体之间有一条端到端的逻辑通信信道。
根据应用需求的不同，因特网的运输层为应用层提供了两种不同的运输协议，即面向连接的TCP和无连接的UDP，这两种协议就是本章要讨论的主要内容。</p></div><footer class=entry-footer><span title='2023-07-31 18:09:28 +0800 CST'>七月 31, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;6 字&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to 从零开始的计算机网络5-1" href=https://blog.0pt.im/learn/1-5-1/></a></article><article class=post-entry><header class=entry-header><h2>从零开始的计算机网络4-9</h2></header><div class=entry-content><p>虚拟专用网VPN与网络地址转换NAT 虚拟专用网VPN(Virtual Private Network) 利用公用的因特网作为本机构各专用网之间的通信载体，这样的专用网又称为虚拟专用网。由于IPv4地址的紧缺，一个机构能够申请到的IPv4地址数量往往远小于本机构所拥有的主机数量。因此，虚拟专用网中的各主机所分配的地址应该是本机构可自由分配的专用地址，而不是需要申请的、在因特网上使用的公有地址。
专用(私有)地址: 10.0.0.0~10.255.255.255(10/8地址块) 172.16.0.0~172.31.255.255(172.16/12地址块)
192.168.0.0~192.168.255.255(192.168/16地址块)
私有地址只能用于机构内部通信，而不能用于和因特网上的主机通信。
从逻辑上看，R1和R2好像是一条直通的点对点链路。因此也被称为IP隧道技术
同一机构内不同部门的内部网络所构成的虚拟专用网VPN又称为内联网VPN 有时一个机构的VPN需要有某些外部机构（通常就是合作伙伴）参加进来。这样的VPN就称为外联网VPN，在外地工作的员工需要访问公司内部的专用网络时，只要在任何地点接入到因特网，运行驻留在员工PC中的VPN软件，在员工的PC和公司的主机之间建立VPN隧道，即可访问专用网络中的资源。这种VPN称为远程接入VPN。
网络地址转换NAT(Network Address Translation)
虽然因特网采用了无分类编址方式来减缓IPv4地址空间耗尽的速度，但由于因特网用户数目的激增，特别是大量小型办公室网络和家庭网络接入因特网的需求不断增加，IPv4地址空间即将面临耗尽的危险仍然没有被解除。
1994年提出了一种网络地址转换NAT的方法再次缓解了IPv4地址空间即将耗尽的问题。
NAT能使大量使用内部专用地址的专用网络用户共享少量外部全球地址来访问因特网上的主机和资源。
该转换方法存在一个问题:如果NAT路由器具有N个全球IP地址，那么至多只能有N个内网主机能够同时和因特网上的主机通信。
由于绝大多数的网络应用都是使用运输层协议TCP或UDP来传送数据，因此可以利用运输层的端口号和IP地址一起进行转换。这样，用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信。这种将端口号和IP地址一起进行转换的技术叫作网络地址与端口号转换NAPT(Network Address and Port Translation)。
外网主机不能首先对内网中的主机发起通信，因为NAPT转换表里找不到相应记录。
内网主机不能直接充当因特网服务器。
对于一些P2P网络应用，需要外网主机主动与内网主机进行通信，在通过NAT时会遇到问题,需要网络应用自己使用一些特殊的NAT穿越技术来解决问题。
另外，由于NAT对外网屏蔽了内网主机的网络地址，能为内网的主机提供一定的安全保护。</p></div><footer class=entry-footer><span title='2023-07-30 18:09:28 +0800 CST'>七月 30, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;29 字&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to 从零开始的计算机网络4-9" href=https://blog.0pt.im/learn/1-4-9/></a></article><article class=post-entry><header class=entry-header><h2>从零开始的计算机网络4-8</h2></header><div class=entry-content><p>网际控制报文协议ICMP 为了更有效地转发lP数据报和提高交付成功的机会，在网际层使用了网际控制报文协议ICMP(Internet Control Message Protocol)。
主机或路由器使用ICMP来发送差错报告报文和询问报文。
ICMP报文被封装在IP数据报中发送。
ICMP差错报告报文共有以下五种:
终点不可达
源点抑制
时间超过
参数问题
改变路由(重定向)
1.终点不可达
当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。
具体可再根据ICMP的代码字段细分为目的网络不可达目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误。
2.源点抑制
当路由器或主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据报的发送速率放慢。
3.时间超过
当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减1。 若结果不为0，则将该IP数据报转发出去;若结果为O，除丢弃该IP数据报外，还要向源点发送时间超过报文。 另外，当终点在预先规定的时间内不能收到一个数据报的全部数据报片时，就把已收到的数据报片都丢弃，也会向源点发送时间超过报文。
4.参数问题
当路由器或目的主机收到IP数据报后，根据其首部中的检验和字段发现首部在传输过程中出现了误码就丢弃该数据报，并向源点发送参数问题报文。
5.改变路由（重定向）
路由器把改变路由报文发送给主机，让主机知道下次应将数据报发送给另外的路由器（可通过更好的路由)。
以下情况不应发送ICMP差错报告报文:
对ICMP差错报告报文不再发送ICMP差错报告报文
对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文
对具有多播地址的数报都不发送ICMP差错报告报文
对具有特殊地址(如127.0.0.0或0.0.0.0)的数据报不发送ICMP差错报告报文
常用的ICMP询问报文有以下两种:
回送请求和回答 ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文。这种询问报文用来测试目的站是否可达及了解其有关状态。
时间戳请求和回答 ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间。在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。这种询问报文用来进行时钟同步和测量时间。
ICMP应用举例
1.分组网间探测PING(Packet InterNet Groper)
用来测试主机或路由器间的连通性
应用层直接使用网际层的ICMP(没有通过运输层的TCP或UDP)
使用ICMP回送请求和回答报文
就是ping
2.跟踪路由traceroute
用来测试IP数据报从源主机到达目的主机要经过哪些路由器
Windows版本 tracert命令 应用层直接使用网际层ICMP 使用了ICMP回送请求和回答报文以及差错报告报文
Unix版本 traceroute命令 在运输层使用UDP协议 仅使用ICMP差错报告报文
跟踪路由traceroute原理
主机依次发送TTL=1、2、3、4…的回送请求报文（1个1个发，当接收到ICMP差错报告后再发下一个）
经过路由依次丢弃IP数据报并给源主机发送ICMP差错报告（时间超过)
当到达目的主机时，目的主机向源主机发送ICMP回送请求的回答报文，源主机就知道到达终点，停止发送回送请求报文。</p></div><footer class=entry-footer><span title='2023-07-29 18:09:28 +0800 CST'>七月 29, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;58 字&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to 从零开始的计算机网络4-8" href=https://blog.0pt.im/learn/1-4-8/></a></article><article class=post-entry><header class=entry-header><h2>从零开始的计算机网络4-7</h2></header><div class=entry-content><p>IPv4数据报的首部格式 首部长度
占4比特，表示IP数据报首部的长度。该字段的取值以4字节为单位。
最小十进制取值为5，表示IP数据报首部只有20字节固定部分;
最大十进制取值为15，表示IP数据报首部包含20字节固定部分和最大40字节可变部分; 可选字段
长度从1个字节到40个字节不等。用来支持排错、测量及安全等措施。
可选字段增加了IP数据报的功能，但这同时也使得IP数据报的首部长度成为可变的。这就增加了每一个路由器处理IP数据报的开销。实际上可选字段很少被使用。
填充字段
确保首部长度为4字节的整数倍。使用全0进行填充。 区分服务
占8比特，用来获得更好的服务。
该字段在旧标准中叫作服务类型，但实际上一直没有被使用过。1998年，因特网工程任务组IETF把这个字段改名为区分服务。利用该字段的不同数值可提供不同等级的服务质量。
只有在使用区分服务时，该字段才起作用。一般情况下都不使用该字段。
总长度
占16比特，表示IP数据报的总长度（首部+数据载荷)。
最大取值为十进制的65535，以字节为单位。
举例：（）为二进制 首部长度=(0101) x 4 = 5 x 4 = 20(字节)
总长度=(0000001111111100) = 1020(字节)
数据载荷长度=总长度-首部长度=1020 - 20 = 1000(字节)
标识
占16比特，属于同一个数据报的各分片数据报应该具有相同的标识。
IP软件维持一个计数器，每产生一个数据报，计数器值加1，并将此值赋给标识字段。
标志
占3比特，各比特含义如下:
DF位:1表示不允许分片;0表示允许分片
MF位:1表示“后面还有分片”;0表示“这是最后一个分片”
保留位:必须为0
片偏移
占13比特，指出分片数据报的数据载荷部分偏移其在原数据报的位置有多少个单位。
片偏移以8个字节为单位。
举例：对IPv4数据报进行分片
片偏移除8是因为片偏移是以字节做单位。
生存时间TTL
占8比特，最初以秒为单位，最大生存周期为255秒;路由器转发IP数据报时，将IP数据报首部中的该字段的值减去IP数据报在本路由器上所耗费的时间，若不为0就转发，否则就丢弃。
现在以“跳数”为单位，路由器转发IP数据报时，将IP数据报首部中的该字段的值减1，若不为0就转发，否则就丢弃。
防止IP数据报在网络中永久兜圈。（前面有提到）
协议
占8比特，指明IPv4数据报的数据部分是何种协议数据单元。常用的一些协议和相应的协议字段值如下。 协议名称 ICMP IGMP TCP UDP lPv6 OSPF 协议字段值 1 2 6 17 41 89 首部检验和
占16比特，用来检测首部在传输过程中是否出现差错。比CRC检验码简单，称为因特网检验和....</p></div><footer class=entry-footer><span title='2023-07-28 18:09:28 +0800 CST'>七月 28, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;88 字&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to 从零开始的计算机网络4-7" href=https://blog.0pt.im/learn/1-4-7/></a></article><article class=post-entry><header class=entry-header><h2>从零开始的计算机网络4-6</h2></header><div class=entry-content><p>路由选择协议概述 静态路由选择
由人工配置的网络路由、默认路由、特定主机路由、黑洞路由等都属于静态路由。
这种人工配置方式简单、开销小。
但不能及时适应网络状态(流量、拓扑等)的变化。
一般只在小规模网络中采用。
动态路由选择
路由器通过路由选择协议自动获取路由信息。
比较复杂、开销比较大。
能较好地适应网络状态的变化。
适用于大规模网络。
因特网所采用的路由选择协议的主要特点
自适应：动态路由选择，能较好地适应网络状态的变化
分布式：路由器之间交换路由信息
分层次：将整个因特网划分为许多较小的自治系统AS(Autonomous System)
因特网采用分层次的路由选择协议
域间路由选择采用外部网关协议EGP
域内路由选择采用内部网关协议IGP
只是路由选择协议的分类名称，不是具体的路由选择协议。网关一词是因为在早期
常见的路由选择协议
路由选择协议
内部网关协议IGP
路由信息协议RIP 基于距离向量，RIP在因特网上最早使用
内部网关路由协议IGRP 基于距离向量，是思科早期私有的协议，现在已被EIGRP取代
增强型内部网关路由协议EIGRP 思科私有的，用来取代IGRP的混合型路由协议(结合距离向量和链路状态)
开放式最短路径优先OSPF 基于链路状态，在各种网络中广泛使用
中间系统到中间系统IS-IS 基于链路状态，是ISP骨干网上最长常用的IGP协议
外部网关协议EGP
边界网关协议BGP 路由器的基本结构
路由表一般仅包含从目的网络到下一跳的映射
路由表需要对网络拓扑变化的计算最优化
转发表是从路由表得出的 转发表的结构应当使查找过程最优化
为方便理解，不严格区分路由表和转发表。
路由信息协议RIP的基本工作原理 路由信息协议RIP(Routing Information Protocol)是内部网关协议IGP中最先得到广泛使用的协议之一，其相关标准文档为RFC 1058。
RIP要求自治系统AS内的每一个路由器都要维护从它自己到AS内其他每一个网络的距离记录。这是一组距离，称为“距离向量D-V(Distance-Vector)”。
RIP使用跳数(Hop Count)作为度量(Metric)来衡量到达目的网络的距离。
路由器到直连网络的距离定义为1。
路由器到非直连网络的距离定义为所经过的路由器数加1。
允许一条路径最多只能包含15个路由器。“距离”等于16时相当于不可达。因此，RIP只适用于小型互联网。
RIP认为好的路由就是“距离短”的路由，也就是所通过路由器数量最少的路由。当到达同一目的网络有多条“距离相等”的路由时，可以进行等价负载均衡。
RIP包含以下三个要点:
和谁交换信息 仅和相邻路由器交换信息
交换什么信息 自己的路由表
何时交换信息 周期性交换（例如每30秒)
RIP基本工作过程
路由器刚开始工作时，只知道自己到直连网络的距离为1。
每个路由器仅和相邻路由器周期性地交换并更新路由信息。
若干次交换和更新后，每个路由器都知道到达本AS内各网络的最短距离和下一跳地址，称为收敛。
RIP的路由条目的更新规则
C将其路由表发给D，结果D改造，对D原有路由表进行更新。
例题：某自治系统内采用RIP协议，若该自治系统内的路由器R1收到其邻居路由器R2的距离矢量，距离矢量中包含信息&lt; net1,16 >，则能得出的结论是
A.R2可以经过R1到达net1，跳数为17 B....</p></div><footer class=entry-footer><span title='2023-07-27 18:09:28 +0800 CST'>七月 27, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;193 字&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to 从零开始的计算机网络4-6" href=https://blog.0pt.im/learn/1-4-6/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://blog.0pt.im/learn/page/3/>«&nbsp;上一页&nbsp;</a>
<a class=next href=https://blog.0pt.im/learn/page/5/>下一页&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://blog.0pt.im/zh/>春风少年兄</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>