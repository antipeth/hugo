<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>从零开始的计算机网络5-5 | 春风少年兄</title><meta name=keywords content="计算机网络"><meta name=description content="五.运输层"><meta name=author content="Me"><link rel=canonical href=https://blog.0pt.im/learn/1-5-5/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.4b652714b710c7fd948e965adf64e815b9d09f68a358365c02ac09b95e5516be.css integrity="sha256-S2UnFLcQx/2UjpZa32ToFbnQn2ijWDZcAqwJuV5VFr4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=icon type=image/png sizes=16x16 href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=icon type=image/png sizes=32x32 href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=apple-touch-icon href=https://img.0pt.im/blogbuilt/title.jpeg><link rel=mask-icon href=https://img.0pt.im/blogbuilt/title.jpeg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="从零开始的计算机网络5-5"><meta property="og:description" content="五.运输层"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.0pt.im/learn/1-5-5/"><meta property="og:image" content="https://blog.0pt.im/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-04T18:09:28+08:00"><meta property="article:modified_time" content="2023-08-04T18:09:28+08:00"><meta property="og:site_name" content="春风少年兄"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.0pt.im/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="从零开始的计算机网络5-5"><meta name=twitter:description content="五.运输层"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"从零开始的计算机网络5-5","item":"https://blog.0pt.im/learn/1-5-5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"从零开始的计算机网络5-5","name":"从零开始的计算机网络5-5","description":"五.运输层","keywords":["计算机网络"],"articleBody":"TCP的拥塞控制 在某段时间，若对网络中某一资源的需求超过了该资源所能提供的可用部分，网络性能就要变坏，这种情况就叫做拥塞(congestion)。\n在计算机网络中的链路容量（即带宽）、交换结点中的缓存和处理机等，都是网络的资源。若出现拥塞而不进行控制，整个网络的吞吐量将随输入负荷的增大而下降。\n慢开始(slow-start)\n拥塞避免(congestion avoidance)\n快重传(fast retransmit)\n快恢复(fast recovery)\n下面介绍这四种拥塞控制算法的基本原理，假定如下条件:\n数据是单方向传送，而另一个方向只传送确认。\n接收方总是有足够大的缓存空间，因而发送方发送窗口的大小由网络的拥塞程度来决定。\n以最大报文段MSS的个数为讨论问题的单位，而不是以字节为单位。\n发送方维护一个叫做拥塞窗口cwnd的状态变量，其值取决于网络的拥塞程度，并且动态变化。\n拥塞窗口cwnd的维护原则:只要网络没有出现拥塞，拥塞窗口就再增大一些;但只要网络出现拥塞，拥塞窗口就减少一些。\n判断出现网络拥塞的依据:没有按时收到应当到达的确认报文（即发生超时重传）。\n发送方将拥塞窗口作为发送窗口swnd，即swnd = cwnd。\n维护一个慢开始门限ssthresh状态变量:\n当cwnd \u003c ssthresh时，使用慢开始算法;\n当cwnd \u003e ssthresh时，停止使用慢开始算法而改用拥塞避免算法;\n当cwnd = ssthresh时，既可使用慢开始算法，也可使用拥塞避免算法。\n设初始时cwnd = 1，ssthresh = 16\n“慢开始”是指一开始向网络注入的报文段少，并不是指拥塞窗口cwnd增长速度慢;\n“拥塞避免”并非指完全能够避免拥塞，而是指在拥塞避免阶段将拥塞窗口控制为按线性规律增长，使网络比较不容易出现拥塞;\n慢开始和拥塞避免算法是1988年提出的TCP拥塞控制算法(TCP Tahoe版本)。\n1990年又增加了两个新的拥塞控制算法（改进TCP的性能），这就是快重传和快恢复（TCP Reno版本)。有时，个别报文段会在网络中丢失，但实际上网络并未发生拥塞。\n这将导致发送方超时重传，并误认为网络发生了拥塞;\n发送方把拥塞窗口cwnd又设置为最小值1，并错误地启动慢开始算法，因而降低了传输效率。\n采用快重传算法可以让发送方尽早知道发生了个别报文段的丢失。\n所谓快重传，就是使发送方尽快进行重传，而不是等超时重传计时器超时再重传。\n要求接收方不要等待自己发送数据时才进行捎带确认，而是要立即发送确认;\n即使收到了失序的报文段也要立即发出对已收到的报文段的重复确认。\n发送方一旦收到3个连续的重复确认，就将相应的报文段立即重传，而不是等该报文段的超时重传计时器超时再重传。\n对于个别丢失的报文段，发送方不会出现超时重传，也就不会误认为出现了拥塞（进而降低拥塞窗口cwnd为1)。使用快重传可以使整个网络的吞吐量提高约20%。\n发送方一旦收到3个重复确认，就知道现在只是丢失了个别的报文段。于是不启动慢开始算法，而执行快恢复算法;\n也有的快恢复实现是把快恢复开始时的拥塞窗口cwnd值再增大一些\n即等于新的ssthresh + 3。\n既然发送方收到3个重复的确认，就表明有3个数据报文段已经离开了网络;\n这3个报文段不再消耗网络资源而是停留在接收方的接收缓存中;\n可见现在网络中不是堆积了报文段而是减少了3个报文段。因此可以适当把拥塞窗口扩大些\n例题：一个TCP连接总是以1KB的最大段长发送TCP段，发送方有足够多的数据要发送。当拥塞窗口为16KB时发生了超时，如果接下来的4个RTT（往返时间)内的TCP段的传输都是成功的，那么当第4个RTT时间内发送的所有TCP段都得到肯定应答时，拥塞窗口大小是\nA.7KB B.8KB C.9KB D.16KB\n解析：\n","wordCount":"63","inLanguage":"zh","datePublished":"2023-08-04T18:09:28+08:00","dateModified":"2023-08-04T18:09:28+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.0pt.im/learn/1-5-5/"},"publisher":{"@type":"Organization","name":"春风少年兄","logo":{"@type":"ImageObject","url":"https://img.0pt.im/blogbuilt/title.jpeg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.0pt.im/zh/ accesskey=h title="世纪大道 (Alt + H)"><img src=https://blog.0pt.im/apple-touch-icon.png alt aria-label=logo height=35>世纪大道</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.0pt.im/zh/search title=找><span>找</span></a></li><li><a href=https://blog.0pt.im/zh/learn/ title=学><span>学</span></a></li><li><a href=https://blog.0pt.im/zh/music/ title=音><span>音</span></a></li><li><a href=https://blog.0pt.im/zh/game/ title=游><span>游</span></a></li><li><a href=https://blog.0pt.im/zh/think/ title=感><span>感</span></a></li><li><a href=https://blog.0pt.im/zh/link/ title=链><span>链</span></a></li><li><a href=https://blog.0pt.im/zh/archives title=时><span>时</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.0pt.im/zh/>主页</a></div><h1 class=post-title>从零开始的计算机网络5-5</h1><div class=post-description>五.运输层</div><div class=post-meta><span title='2023-08-04 18:09:28 +0800 CST'>八月 4, 2023</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;63 字&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/antipeth/hugo/content/posts/learn/1-5-5.md rel="noopener noreferrer" target=_blank></a></div></header><div class=post-content><h1 id=tcp的拥塞控制>TCP的拥塞控制<a hidden class=anchor aria-hidden=true href=#tcp的拥塞控制>#</a></h1><p>在某段时间，若<strong>对网络中某一资源的需求超过了该资源所能提供的可用部分</strong>，网络性能就要变坏，这种情况就叫做拥塞(congestion)。</p><p>在计算机网络中的链路容量（即带宽）、交换结点中的缓存和处理机等，都是网络的资源。若<strong>出现拥塞而不进行控制</strong>，整个网络的<strong>吞吐量将随输入负荷的增大而下降</strong>。</p><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-1.png alt></p><ul><li><p>慢开始(slow-start)</p></li><li><p>拥塞避免(congestion avoidance)</p></li><li><p>快重传(fast retransmit)</p></li><li><p>快恢复(fast recovery)</p></li></ul><p>下面介绍这四种拥塞控制算法的基本原理，假定如下条件:</p><ul><li><p>数据是单方向传送，而另一个方向只传送确认。</p></li><li><p>接收方总是有足够大的缓存空间，因而发送方发送窗口的大小由网络的拥塞程度来决定。</p></li><li><p>以最大报文段MSS的个数为讨论问题的单位，而不是以字节为单位。</p></li></ul><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-2.png alt></p><p>发送方维护一个叫做<strong>拥塞窗口cwnd</strong>的状态变量，其值<strong>取决于网络的拥塞程度</strong>，并且<strong>动态变化</strong>。</p><ul><li><p>拥塞窗口<strong>cwnd的维护原则</strong>:只要网络<strong>没有出现拥塞</strong>，<strong>拥塞窗口</strong>就再<strong>增大</strong>一些;但只要网络<strong>出现拥塞</strong>，<strong>拥塞窗口就减少</strong>一些。</p></li><li><p>判断出现<strong>网络拥塞的依据</strong>:没有按时收到应当到达的确认报文（即<strong>发生超时重传</strong>）。</p></li></ul><p>发送方将拥塞窗口作为<strong>发送窗口swnd</strong>，即<strong>swnd = cwnd</strong>。</p><p>维护一个慢开始门限<strong>ssthresh</strong>状态变量:</p><ul><li><p>当cwnd &lt; ssthresh时，使用慢开始算法;</p></li><li><p>当cwnd > ssthresh时，停止使用慢开始算法而改用拥塞避免算法;</p></li><li><p>当cwnd = ssthresh时，既可使用慢开始算法，也可使用拥塞避免算法。</p></li></ul><p>设初始时cwnd = 1，ssthresh = 16</p><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-3.png alt></p><p>“慢开始”是指一开始向网络注入的报文段少，并不是指拥塞窗口cwnd增长速度慢;</p><p>“拥塞避免”并非指完全能够避免拥塞，而是指在拥塞避免阶段将拥塞窗口控制为按线性规律增长，使网络比较不容易出现拥塞;</p><p>慢开始和拥塞避免算法是1988年提出的TCP拥塞控制算法(TCP Tahoe版本)。</p><p>1990年又增加了两个新的拥塞控制算法（<strong>改进TCP的性能</strong>），这就是快重传和快恢复（TCP Reno版本)。有时，<strong>个别报文段</strong>会在网络中<strong>丢失</strong>，但实际上网络<strong>并未发生拥塞</strong>。</p><ul><li><p>这将导致<strong>发送方</strong>超时重传，并<strong>误认为</strong>网络发生了<strong>拥塞</strong>;</p></li><li><p><strong>发送方把拥塞窗口cwnd又设置为最小值1</strong>，并错误地启动慢开始算法，因而<strong>降低了传输效率</strong>。</p></li></ul><p>采用快重传算法可以<strong>让发送方尽早知道发生了个别报文段的丢失</strong>。</p><p>所谓快重传，就是使发送方<strong>尽快进行重传</strong>，而<strong>不是等超时重传计时器超时</strong>再重传。</p><ul><li><p>要求接收方不要等待自己发送数据时才进行捎带确认，而是要<strong>立即发送确认</strong>;</p></li><li><p>即使收到了失序的报文段也要立即发出对已收到的报文段的<strong>重复确认</strong>。</p></li><li><p>发送方一旦收到<strong>3个连续的重复确认</strong>，就将相应的报文段<strong>立即重传</strong>，而不是等该报文段的超时重传计时器超时再重传。</p></li><li><p>对于个别丢失的报文段，发送方不会出现超时重传，也就不会误认为出现了拥塞（进而降低拥塞窗口cwnd为1)。使用快重传可以使整个网络的吞吐量提高约20%。</p></li></ul><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-4.png alt></p><p><strong>发送方一旦收到3个重复确认</strong>，就知道现在只是丢失了个别的报文段。于是不启动慢开始算法，<strong>而执行快恢复算法</strong>;</p><p>也有的快恢复实现是把快恢复开始时的拥塞窗口cwnd值再增大一些</p><p>即等于新的ssthresh + 3。</p><ul><li><p>既然发送方收到3个重复的确认，就表明有3个数据报文段已经离开了网络;</p></li><li><p>这3个报文段不再消耗网络资源而是停留在接收方的接收缓存中;</p></li><li><p>可见现在网络中不是堆积了报文段而是减少了3个报文段。因此可以适当把拥塞窗口扩大些</p></li></ul><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-5.png alt></p><p>例题：一个TCP连接总是以1KB的最大段长发送TCP段，发送方有足够多的数据要发送。当拥塞窗口为16KB时发生了超时，如果接下来的4个RTT（往返时间)内的TCP段的传输都是成功的，那么当第4个RTT时间内发送的所有TCP段都得到肯定应答时，拥塞窗口大小是</p><p>A.7KB B.8KB C.9KB D.16KB</p><p>解析：</p><p><img loading=lazy src=https://img.0pt.im/computernet/5-5/5-5-6.png alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.0pt.im/zh/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/>计算机网络</a></li></ul><nav class=paginav><a class=prev href=https://blog.0pt.im/learn/1-5-6/><span class=title>« 上一页</span><br><span>从零开始的计算机网络5-6</span></a>
<a class=next href=https://blog.0pt.im/learn/1-5-4/><span class=title>下一页 »</span><br><span>从零开始的计算机网络5-4</span></a></nav></footer><style>.comments_details summary::marker{font-size:20px;content:'👉展开评论';color:var(--content)}.comments_details[open] summary::marker{font-size:20px;content:'👇关闭评论';color:var(--content)}</style><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script>
<script>twikoo.init({envId:"https://twikoo-ten-pearl.vercel.app/",el:"#tcomment",lang:"zh-CN",region:"",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.0pt.im/zh/>春风少年兄</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>